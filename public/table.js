(()=>{"use strict";var e=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"GET",r=e,a={method:n};return"GET"===n?r+="?".concat(new URLSearchParams(t).toString()):(a.body=JSON.stringify(t),a.headers={"Content-Type":"application/json;charset=utf-8"}),fetch(r,a).then((function(e){return e.json()}))};function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function r(e,n){if(n&&("object"===t(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return a(e)}function a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function o(e){var t="function"==typeof Map?new Map:void 0;return o=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return i(e,arguments,u(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),l(r,e)},o(e)}function i(e,t,n){return i=c()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var a=new(Function.bind.apply(e,r));return n&&l(a,n.prototype),a},i.apply(null,arguments)}function c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function l(e,t){return l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},l(e,t)}function u(e){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},u(e)}var s="ASC",d="DESC",f="&#9660;",p="&#9650;",g="&#9650;&#9660;",m=function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}(b,t);var o,i,m,y,v,h=(o=b,i=c(),function(){var e,t=u(o);if(i){var n=u(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return r(this,e)});function b(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,b),(e=h.call(this)).div=a(e),e.options=JSON.parse(e.dataset.options),e.base_url=e.options.ajax.url,e.table=e.querySelector("table.datable"),e.tableBody=e.table.querySelector("tbody"),e.pageActive=e.options.pageActive,e.nbElementPerPage=e.options.pageLength,e.order=[],e.filter={},e.tableBody.innerHTML="",e.options.columns.forEach((function(t){!0===t.orderable&&(null!=t.order&&(e.order=[{column:t.id,order:t.order}]),document.getElementById(t.id).style.cursor="pointer",document.getElementById(t.id).addEventListener("click",(function(t){e.order=[{column:t.target.id,order:t.target.dataset.order}],e._updateHeader(),e._buildArray()})))})),e.form=e.getElementsByTagName("form");var t=document.getElementById("eraseFiltre");(null!=t&&t.addEventListener("click",(function(t){t.preventDefault(),e.filter={},e._clearForm(),e._buildArray()})),e.inputs=e.form[0].getElementsByTagName("input"),e.selects=e.form[0].getElementsByTagName("select"),Array.from(e.inputs).forEach((function(t){"text"===t.type&&t.addEventListener("keyup",(function(t){"text"===t.target.type&&t.target.value.length<3||(e._getFilterFromField(t.target),e._buildArray())})),"radio"!==t.type&&"checkbox"!==t.type||t.addEventListener("change",(function(t){e._getFilterFromField(t.target),e._filterArray()}))})),Array.from(e.selects).forEach((function(t){t.addEventListener("change",(function(t){e._getFilterFromField(t.target),e._filterArray()}))})),!0===e.options.paging)&&document.getElementById("".concat(e.options.paging_id,"_select")).addEventListener("change",(function(t){t.preventDefault(),e.nbElementPerPage=t.target.value,e._buildArray()}));return e._initHeader(),e._buildArray(),e}return m=b,v=[{key:"_extractNameFromForm",value:function(e){var t=e.split("[");return t[1].substr(0,t[1].length-1)}}],(y=[{key:"_filterArray",value:function(){this._buildArray()}},{key:"_updateHeader",value:function(){this.order.forEach((function(e){var t=document.getElementById(e.column);e.order===s?(t.innerHTML="".concat(t.dataset.originalName," ").concat(p),t.dataset.order="DESC"):e.order===d?(t.innerHTML="".concat(t.dataset.originalName," ").concat(f),t.dataset.order="ASC"):(t.innerHTML="".concat(t.dataset.originalName," ").concat(g),t.dataset.order="ASC")}))}},{key:"_buildArray",value:function(){var t,n,r=this;this.tableBody.innerHTML="",(t=this.base_url,n={paging:{pageLength:this.nbElementPerPage,pageActive:this.pageActive},order:this.order,filter:this.filter},e(t,n,"POST")).then((function(e){if(e.data.length>0)e.data.forEach((function(e){var t="<tr>";r.options.columns.forEach((function(n){t+="<td>".concat(e[n.id],"</td>")})),t+="</tr>",r.tableBody.innerHTML+=t}));else{var t="<tr>";t+='<td colspan="'.concat(r.options.columns.length,'" class="text-center">Pas de donn√©es.</td>'),t+="</tr>",r.tableBody.innerHTML=t}r._updatePagination(e.paging)}))}},{key:"_initHeader",value:function(){this.options.columns.forEach((function(e){var t=document.getElementById(e.id).innerText;document.getElementById(e.id).dataset.originalName=t,!0===e.orderable&&(e.order===d?(document.getElementById(e.id).innerHTML="".concat(t," ").concat(f),document.getElementById(e.id).dataset.order=d):e.order===s?(document.getElementById(e.id).innerHTML="".concat(t," ").concat(p),document.getElementById(e.id).dataset.order=s):(document.getElementById(e.id).innerHTML="".concat(t," ").concat(g),document.getElementById(e.id).dataset.order=s))}))}},{key:"_updatePagination",value:function(e){var t=this,n=document.getElementById("".concat(this.options.paging_id,"_nav")),r=!0===e.firstPage?"disabled":"",a=!0===e.lastPage?"disabled":"",o=e.numActivePage-1,i=e.numActivePage+1,c='<ul class="pagination justify-content-end">\n                        <li class="page-item '.concat(r,'">\n                            <a class="page-link" href="#">\n                                <span class="fas fa-arrow-left"></span>\n                            </a>\n                        </li>');if(e.nbPages<=10)for(var l=1;l<=e.nbPages;l+=1){var u=l===e.numActivePage?"active":"";c+='<li class="page-item '.concat(u,'">\n                  <a class="page-link" href="#">').concat(l,"</a>\n               </li>")}else{if(e.numActivePage>2&&(c+='<li class="page-item"><a class="page-link" href="#">1</a></li>',e.numActivePage>3)){var s=e.numActivePage-2;c+='<li class="page-item"><a class="page-link" href="#" data-page="'.concat(s,'">...</a></li>')}1===e.numActivePage?i+=2:2===e.numActivePage&&(i+=1),e.numActivePage===e.nbPages?o-=2:e.numActivePage===e.nbPages-1&&(o-=1);for(var d=o;d<=i;d++)if(0===d&&(d+=1),!(d>e.nbPages)){var f=d===e.numActivePage?"active":"";c+='<li class="page-item '.concat(f,'"><a class="page-link" href="#">').concat(d,"</a></li>")}if(e.numActivePage<e.nbPages-1){if(e.numActivePage<e.nbPages-2){var p=0;p=1===e.numActivePage?e.numActivePage+4:e.numActivePage+2,c+='<li class="page-item"><a class="page-link" href="#" data-page="'.concat(p,'">...</a></li>')}c+='<li class="page-item"><a class="page-link" href="#">'.concat(e.nbPages,"</a></li>")}}c+='<li class="page-item '.concat(a,'">\n                  <a class="page-link" href="#">\n                      <span class="fas fa-arrow-right"></span>\n                  </a>\n              </li>\n          </ul>'),n.innerHTML=c,this.div.querySelectorAll(".page-link").forEach((function(e){e.addEventListener("click",(function(e){var n=e.target.innerText;"..."===n&&(n=e.target.dataset.page),t.pageActive=n,t._buildArray()}))}))}},{key:"_getFilterFromField",value:function(e){var t=b._extractNameFromForm(e.name);"checkbox"===e.type?!0===e.checked&&(t in this.filter||(this.filter[t]=[]),this.filter[t].push(e.value)):this.filter[t]=e.value}},{key:"_clearForm",value:function(){Array.from(this.inputs).forEach((function(e){"text"===e.type&&(e.value=""),"radio"!==e.type&&"checkbox"!==e.type||(e.checked=!1)})),Array.from(this.selects).forEach((function(e){e.value=""}))}}])&&n(m.prototype,y),v&&n(m,v),Object.defineProperty(m,"prototype",{writable:!1}),b}(o(HTMLElement));customElements.define("my-table",m),console.log("coucou")})();